# SPDX-FileCopyrightText: 2021 iteratec GmbH
#
# SPDX-License-Identifier: Apache-2.0

apiVersion: "execution.securecodebox.io/v1"
kind: ScanCompletionHook
metadata:
  name: {{ include "update-field.fullname" . }}
  labels:
    {{- include "update-field.labels" . | nindent 4 }}
    {{- with .Values.hook.labels }}
    {{ toYaml . }}
    {{- end }}
spec:
  type: ReadAndWrite
  image: "{{ .Values.hook.image.repository }}:{{ .Values.hook.image.tag | default .Chart.Version }}"
  ttlSecondsAfterFinished: {{ .Values.hook.ttlSecondsAfterFinished }}
  env:
    - name: ATTRIBUTE_NAME
      value: {{ .Values.attribute.name | quote }}
    - name: ATTRIBUTE_VALUE
      value: {{ .Values.attribute.value | quote }}
