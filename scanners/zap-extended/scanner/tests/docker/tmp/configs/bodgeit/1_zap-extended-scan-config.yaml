---
# List of 1 or more contexts, mandatory
contexts:
  # Name to be used to refer to this context in other jobs, mandatory
  - name: secureCodeBox-BodgeIT-Context
    # The top level url, mandatory, everything under this will be included
    url: http://localhost:8080/bodgeit
    # An optional list of regexes to include
    includePaths:
      - "http://localhost:8080/bodgeit.*"
    # An optional list of regexes to exclude
    excludePaths:
      - ".*\\.js"
      - ".*\\.css"
      - ".*\\.png"
      - ".*\\.jpeg"
    # Auth Credentials for the scanner to access the application
    # Can be either basicAuth or a oidc token.
    # If both are set, the oidc token takes precedent
    # More infos about "ZAP Authentication for BodgeIT": https://play.sonatype.com/watch/B1vhaLSUsme7eA5hU8WeGB?
    authentication:
      # Currently supports "basic-auth", "form-based", "json-based", "script-based"
      type: "form-based"
      # basic-auth requires no further configuration
      form-based:
        loginUrl: "http://localhost:8080/bodgeit/login.jsp"
        # must be escaped already to prevent yaml parser colidations 'username={%username%}&password={%password%}''
        loginRequestData: "username%3D%7B%25username%25%7D%26password%3D%7B%25password%25%7D"
      # Indicates if the current Zap User Session is based on a valid authentication (loggedIn) or not (loggedOut)
      verification:
        isLoggedInIndicator: '\\Q<a href="password.jsp">\\E'
        isLoggedOutIndicator: '\\QGuest user\\E'
    users:
      - name: "bodgeit-user-1"
        username: "test@thebodgeitstore.com"
        password: "password"
    session:
      # Currently supports "scriptBasedSessionManagement", "cookieBasedSessionManagement", "httpAuthSessionManagement"
      type: "cookieBasedSessionManagement"
